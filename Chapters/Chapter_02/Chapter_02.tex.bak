\chapter{Relative dynamics around a near-circular reference orbit.}
%
\label{chap: HCW}
%
\section{Introduction.}
%
%
\section{Motion model: Hill equations.}
%
\indent
%
	\subsection{Differential equations of proximity relative motion.} \label{sec: Diff_eqs_prox}
	%
	\indent As the proximity assumption ($\norm{\underline{r}} <<\norm{\underline{R}}$) is quite widely common and valid for a fair range of operations, it is interesting to describe them here briefly, following \cite{Yamanaka_ankersen}. Let us then consider the motion of two spacecrafts, namely, chief and deputy. The general equations of motion for each of them can be written as:
	%
	\begin{alignat}{3}
	&\textbf{Chief} 		&& \Rightarrow   \underline{\ddot{R}}   && = - \mu \dfrac{\underline{R}}{\norm{\underline{R}}} + \underline{a}_{C, d} \label{eqCh2:	chief_eq} \\
	&\textbf{Deputy} 		&& \Rightarrow   \underline{\ddot{R}} + \underline{\ddot{r}}  && =  - \mu \dfrac{\underline{R} + \underline{r}}{\norm{\underline{R} + \underline{r}}} + \underline{a}_{D, d} + \underline{a_f}  \label{eqCh2:deputy_eq}
	\end{alignat}
	%
	\noindent where $\underline{R}$ and $\underline{r}$ are the chief's absolute position vector and the deputy's relative position vector, respectively. $\underline{a}_{\bullet, d}$ is the disturbing acceleration on each spacecraft, while $\underline{a}_f$ denotes the thrust vector of the deputy. In order to facilitate the linearization, let us rewrite the orbital radius of the deputy as:
	%
	\[
	\norm{\underline{R} + \underline{r}} = \left[ (\underline{R} + \underline{r})^T (\underline{R} + \underline{r}) \right]^{1/2} = \norm{\underline{R}} \left( 1 + 2 \dfrac{\underline{R}^T \underline{r}}{\norm{\underline{R}}^2} + \dfrac{\norm{\underline{r}}^2}{\norm{\underline{R}}^2} \right)^{1/2}
	\]
	%
	\noindent then, the effect of the gravity field on the deputy can be expressed as:
	%
	\[
	\dfrac{\underline{R} + \underline{r}}{\norm{\underline{R} + \underline{r}}^{3}} = \dfrac{\underline{R} + \underline{r}}{\norm{\underline{R}}^{3}} = \left( 1 + 2 \dfrac{\underline{R}^T \underline{r}}{\norm{\underline{R}}^2} + \dfrac{\norm{\underline{r}}^2}{\norm{\underline{R}}^2} \right)^{-\frac{3}{2}}
	\]
	\indent Assuming that the relative distance is much smaller than the chief's orbital radius:
	%
	\begin{equation}
	\dfrac{\underline{R} + \underline{r}}{\norm{\underline{R} + \underline{r}}^{3}} \approx \dfrac{\underline{R} + \underline{r}}{\norm{\underline{R}}^{3}} \left[1 - \frac{3}{2} \left( 2 \dfrac{\underline{R}^T \underline{r}}{\norm{\underline{R}}^2} + \dfrac{\norm{\underline{r}}^2}{\norm{\underline{R}}^2} \right) \right] \approx  \dfrac{1}{\norm{\underline{R}}^{3}} \left(\underline{R} + \underline{r} - 3 \dfrac{\underline{R}^T \underline{r}}{\norm{\underline{R}}^2} \underline{R} \right)
	\label{eqCh2: 	Rplusr}
	\end{equation}
	%
	\indent If we now substitute \eqref{eqCh2: 	Rplusr} in the difference \eqref{eqCh2:	deputy_eq} minus \eqref{eqCh2:	chief_eq}, we arrive to:
	%
	\begin{equation}
	\underline{\ddot{r}} = - \dfrac{\mu}{\norm{\underline{R}}^3} \left(\underline{r} - 3 \dfrac{\underline{R}^T \underline{r}}{\norm{\underline{R}}^2} \underline{R} \right) + \underline{a}_f + \underline{a}_{D, d} - \underline{a}_{C, d}
	\label{eqCh2: 	Rel_motion_1}
	\end{equation}
	%
	\indent Experience shows it is convenient to express equation \eqref{eqCh2: 	Rel_motion_1} in a chief-centered frame, for example, the LVLH frame (see section \ref{secAppB:LVLH}). This leads to the need of applying Coriolis' Theorem twice, so as to get the non-inertial effects derived from describing the motion in a rotating frame. The equations of motion take now the following form:
	%
	\begin{equation}
	\underline{\ddot{r}} = - \dfrac{\mu}{\norm{\underline{R}}^3} \left(\underline{r} - 3 \dfrac{\underline{R}^T \underline{r}}{\norm{\underline{R}}^2} \underline{R} \right) - 2 \underline{\omega}\times  \underline{\dot{r}} - \underline{\dot{\omega}}\times \underline{r} - \underline{\omega}\times \left( \underline{\omega} \times \underline{r}\right) + \underline{a}_f + \underline{a}_{D, d} - \underline{a}_{C, d}
	\label{eqCh2: 	Rel_motion_2}
	\end{equation}
	%
	\noindent where $\underline{\omega}$ is the target orbital rate. Let us now express each vector in the RTN frame:
	%
	\begin{align}
	\underline{\omega} = 
	\left\{ \begin{array}{c}
	0 \\
	-\omega \\
	0
	\end{array}\right\} 
	& \qquad &
	\underline{R} = 
	\left\{ \begin{array}{c}
	0 \\
	0 \\
	-R
	\end{array}\right\} 
	& \qquad &
	\underline{r} = 
	\left\{ \begin{array}{c}
	x \\
	y \\
	z
	\end{array}\right\} 
	\end{align}
	\noindent leading to the next expressions for the terms in equation \eqref{eqCh2: 	Rel_motion_2}:
	%
	\begin{align*}
	\underline{\omega}\times \underline{\dot{r}} = 
	\left\{ \begin{array}{c}
	\omega \dot{z} \\
	0 \\
	\omega \dot{x}
	\end{array}\right\} 
	& \qquad &
	\underline{\dot{\omega}} \times \underline{r} = 
	\left\{ \begin{array}{c}
	-\dot{\omega} z\\
	0 \\
	\dot{\omega} x
	\end{array}\right\} 
	\\
	\underline{\omega}\times\left(\underline{\omega} \times\underline{r}\right) = 
	\left\{ \begin{array}{c}
	- \omega^2 x \\
	0 \\
	- \omega^2 z 
	\end{array}\right\} 
	& \qquad &
	\underline{r} - 3 \dfrac{\underline{R}^T \underline{r}}{\norm{\underline{R}}^2} = 
	\left\{ \begin{array}{c}
	x \\
	y \\
	- 2 z 
	\end{array}\right\} 
	\end{align*}
	%
	\noindent and introducing these results into \eqref{eqCh2: 	Rel_motion_2}, we arrive to:
	%
	\begin{equation}
	\left\{
	\begin{array}{c}
	\ddot{x}\\
	\ddot{y}\\
	\ddot{z}
	\end{array}\right\}
	= 
	\left\{
	\begin{array}{c}
	- k \omega^{3/2} x + 2\omega \dot{z} + \dot{\omega} z + \omega^2 x	\\
	-k \omega^{3/2} y \\
	2k\omega^{3/2} z - 2 \omega \dot{x} - \dot{\omega} x + \omega^2 z
	\end{array}\right\}
	+ \underline{a}_f + \underline{a}_{D, d} - \underline{a}_{C, d}
	\label{eqCh2: Diff_eqs_prox}
	\end{equation}
	%
	\noindent where $k$ is a constant defined by 
	%
	\[
	\dfrac{\mu}{R^3} = \left(\dfrac{\mu }{h^{3/2}}\right) \equiv k \omega^{3/2} \Leftrightarrow k \equiv \dfrac{\mu} {h^{3/2}}
	\]
	%
	\indent and $h = \omega R^2$ is the chief's angular momentum. TO BE CONTINUED, MATRIX FORM OF HILL EQUATIONS. ALSO ADD VECTOR NOTATION OF EACH. RTN FRAME FOR HCW?

	\subsection{Hill equations.}
	%
	%
\section{Solutions of Hill equations.}
%
%
	\subsection{Approaches.}
	%
	%
		\subsection{Direct numerical integration.}
		%
		%
		\subsection{Clohessy-Wiltshire solution.}
		%
		%
		\subsection{State transition matrix propagation.}
		%
		%
		\subsubsection{Jordan canonical decomposition.}
		%
		%
	\subsection{Results: Comparison against High-Fidelity.}
	%
	%
		\subsubsection{Scenario 1: XXXXXX}
		%
		%
		\subsubsection{Scenario 2: XXXXXX}
		%
		%
		\subsubsection{Scenario 3: XXXXXX}
		%
		%

\section{Orbit safety in near-circular orbits.}
%
%
	\subsection{Orbit safety concept.}
	%
	\indent Orbit or trajectory safety can be understood as how protected from danger or risk our spacecraft set is. It is essentially a kinematic condition, being closely related to the notions of relative position and distance, and how these vary over time. Both branches of relative motion (\ie rendez-vous and formation flying) are subject to this concept. \\
	%
	\indent One of the biggest concerns about orbit safety is trajectory uncertainty. If we knew the exact position of each spacecraft, safety margins could be lowered down to almost zero, but unfortunately, that is not the case. For this reason, distance margins have to be established. As we have seen, there are three basic components in relative motion: radial, along-track and cross-track. The most susceptible one to estimation errors is the along-track component, due to the high influence of the semimajor axis on the angular rate, thus on the angular position \cite{Eckstein}. Hence, along-track uncertainty will always tend to be much higher than either radial or cross-track.\\
	%
	\indent With this fact in mind, it seems logical to try and separate the spacecrafts in radial or cross-track components, as motion can be more accurately predicted in those directions. It is here where the eccentricity/inclination vector separation concept raises, as an approach to describe the periodic relative motion that takes place in said components. In the following section, its grounds and applications will be discussed, both in general terms and applied to near-circular reference orbits.
	%
	\subsection{Eccentricity-inclination vector separation strategy.}
	%
	%
		\subsubsection{Eccentricity and inclination vectors.}
		%
		\indent The eccentricity and inclination vectors constitute an interesting way to parametrize relative motion. This description was firstly introduced by Eckstein \cite{Eckstein}, aimed at geostationary orbits. Later on, it was extended to proximity LEO operations \cite{Montenbruck_DAmico}, which is today's main scope of application. \\
		%
		\indent This approach to orbit safety will be treated recurrently along the thesis, being progressively extended as the orbits grow in complexity. In this section, the basics of this concept will be described, starting with the parametrization of proximity relative motion in terms of the eccentricity and inclination vectors (see appendix \ref{sec:EIROE}). After that, the two setups of $\delta \underline{e}$ and $\delta \underline{i}$ are discussed.
		%
		\subsubsection{Linearized effect of $\delta e$ and $\delta i$ in relative position.}
		%
		\indent Our target is to obtain an expression which relates the eccentricity and inclination vector components to the radial, along-track and cross-track distances. This can be done by applying some transformations to the already available Keplerian OE set to RTN (see \ref{sec:RKOE2RTN}), or through a geometric analysis of the motion. As the first one is almost trivial (considered said section), let us proceed with the second one.\\
		%
			\paragraph{Effect of relative eccentricity vector $\delta \underline{e}$. \\}
			%
			\indent The relative eccentricity vector accounts for the variation in the eccentricity value and the argument of perigee. Assuming no other variation in any element, it can be projected on the chief's orbital plane, leading to:
			%
			\[
			\underline{e} = \left\{ 
			\begin{array}{c}
			 e_x \\[1.5em]
			 e_y
			\end{array}\right\} 
			 = e \begin{array}{c}
			 \cos\omega \\[1.5em]
			 \sin\omega \Rightarrow
			\end{array}\right\} 
			\delta \underline{e} = 
			\left\{ 
			\begin{array}{c}
			\delta e_x \\[1.5em]
			\delta e_y
			\end{array}
			\right\} = \delta e
			\left\{ 
			\begin{array}{c}
			\cos\varphi \\[1.5em]
			\sin\varphi
			\end{array}
			\right\}
			\]
			%
			\indent The relative eccentricity has an effect on the in-plane motion. That is to say, on the radial and along-track components. In order to get these, we must first derive some expressions for the orbital radius $r$ and the difference $\theta - M$. \\
			%
			\indent The orbital radius for near-circular orbits ($\abs{e}<<1$) can be expressed as:
			%
			\begin{align}
			\nonumber \dfrac{r}{a} = 1 -e\cos E \approx 1 - e\cos M = 1 - e\cos\left(\lambda - \omega\right) = 1 - e\cos\omega \cos \lambda+ e \sin \lambda \sin\omega \\
			\dfrac{r}{a} \approx 1 - e_x \cos\lambda - e_y \sin \lambda
			\label{eqCh2:orbital_radius}
			\end{align}
			%
			\noindent where $\lambda$ is the mean argument of perigee, which embodies the time-varying element of the E/I element set. The second auxiliary expression $\theta - M$ can be obtained in many handbooks, by looking for the series expansion of the mean anomaly in terms of the true \cite{Battin}:
			%
			\begin{align}
			&\nonumber M =\theta+ 2\dsum_{n=1}^{\infty} (-1)^{n} \left( \dfrac{1}{n} + \sqrt{1 - e^2} \right) \beta^n \sin n\theta \underset{e<<1}{\approx} \theta - 2 e \sin\theta\\
			& \theta - M = 2 e\sin M = 2 e \sin\left(\lambda - \omega\right) = 2e\left(\sin\lambda\cos\omega - \cos\lambda\sin\omega\right) = 2 e_x\sin u - 2 e_y \cos\lam
			\label{eqCh2:M_expansion}
			\end{align}
			
			
			
		%
		\subsubsection{Collision avoidance: $\delta{\underline{e}} / \delta{\underline{i}}$ separation.}
		%
		%
			\paragraph{Parallel configuration. \\}
			%
			%
			\paragraph{Antiparallel configuration. \\}
			%
			%
